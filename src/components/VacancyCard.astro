---
interface Props {
  id: string;
  title: string;
  description: string;
  requirements?: string;
  location: string;
  remoteAllowed: boolean;
  seniority: string;
  status: string;
  salaryMin?: number;
  salaryMax?: number;
  currency?: string;
  buttonText?: string;
  buttonHref?: string;
}

const {
  id,
  title,
  description,
  requirements,
  location,
  remoteAllowed,
  seniority,
  status,
  salaryMin,
  salaryMax,
  currency = "USD",
} = Astro.props;

// Format salary range
const formatSalary = (min?: number, max?: number, curr?: string) => {
  if (!min && !max) return null;
  const formatter = new Intl.NumberFormat("en-US", {
    style: "currency",
    currency: curr || "USD",
    maximumFractionDigits: 0,
  });
  if (min && max) return `${formatter.format(min)} - ${formatter.format(max)}`;
  if (min) return `From ${formatter.format(min)}`;
  if (max) return `Up to ${formatter.format(max)}`;
  return null;
};

const salaryDisplay = formatSalary(salaryMin, salaryMax, currency);
const locationDisplay = remoteAllowed ? `${location} (Remote)` : location;
---

<div class="vacancy-card" data-vacancy-id={id}>
  <div class="vacancy-header">
    <h3>{title}</h3>
    <span class={`vacancy-status status-${status.toLowerCase()}`}>{status}</span
    >
  </div>

  <div class="vacancy-info">
    <div class="vacancy-info-item">
      <span>üìç</span>
      <span><strong>Location:</strong> {locationDisplay}</span>
    </div>
    <div class="vacancy-info-item">
      <span>üíº</span>
      <span><strong>Seniority:</strong> {seniority}</span>
    </div>
    {
      salaryDisplay && (
        <div class="vacancy-info-item">
          <span>üí∞</span>
          <span>
            <strong>Salary:</strong> {salaryDisplay}
          </span>
        </div>
      )
    }
  </div>

  <p class="vacancy-description">{description}</p>

  {
    requirements && (
      <div class="vacancy-requirements">
        <strong>Requirements:</strong>
        <p>{requirements}</p>
      </div>
    )
  }

  <a href={`/apply/${id}`} class="btn-primary vacancy-btn">Apply now</a>
</div>
